<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HeaderSleuth++</title>
<style>
  body { font-family: monospace; background: #1e1e1e; color: #eee; margin: 0; padding: 1rem; }
  input, textarea, button { font-family: monospace; font-size: 1rem; margin: 0.2rem 0; width: 100%; }
  button { cursor: pointer; padding: 0.5rem; }
  .analysis-table, .diff-table { width: 100%; border-collapse: collapse; margin: 0.5rem 0; }
  .analysis-table th, .analysis-table td, .diff-table th, .diff-table td { border: 1px solid #555; padding: 0.2rem 0.5rem; text-align: left; }
  .diff { background: #4d0000; }
  .same { background: #003300; }
  .finding { border: 1px solid #444; margin: 0.3rem 0; padding: 0.3rem; border-radius: 4px; }
  .finding.high { border-color: #f33; }
  .finding.medium { border-color: #f90; }
  .finding.low { border-color: #3cf; }
  .btn-poc, .btn-copy { margin-right: 0.2rem; }
  .score-pill { display: inline-block; padding: 0.3rem 0.5rem; border-radius: 4px; margin: 0.5rem 0; }
  .score-pill.green { background: #0a0; color: #fff; }
  .score-pill.orange { background: #f80; color: #000; }
  .score-pill.red { background: #f00; color: #fff; }
  textarea { min-height: 120px; background: #222; color: #eee; border: 1px solid #555; padding: 0.5rem; }
  .panel { border: 1px solid #555; padding: 0.5rem; margin: 0.5rem 0; border-radius: 4px; background: #2a2a2a; }
</style>
</head>
<body>

<h1>HeaderSleuth++</h1>

<div class="panel">
  <h2>Target & CORS PoC</h2>
  <input id="target" placeholder="Enter target URL (https://example.com)" />
  <input id="origins" placeholder="CORS test origins, comma separated" />
  <label><input type="checkbox" id="cred" /> Test credentials</label>
  <label><input type="checkbox" id="preflight" /> Test preflight OPTIONS</label>
  <button id="genCurl">Generate PoC</button>
  <button id="copyCurl">Copy to Clipboard</button>
  <button id="downloadCurl">Download Script</button>
  <pre id="curlOutput"></pre>
</div>

<div class="panel">
  <h2>Paste Headers for Analysis (A)</h2>
  <textarea id="pasteA" placeholder="Paste raw headers here (A)"></textarea>
  <button id="analyzeA">Analyze A</button>
</div>

<div class="panel">
  <h2>Paste Headers for Analysis (B)</h2>
  <textarea id="pasteB" placeholder="Paste raw headers here (B)"></textarea>
  <button id="analyzeB">Analyze B</button>
</div>

<div class="panel">
  <h2>Pattern Search</h2>
  <input id="patternSearch" placeholder="Enter comma-separated regex patterns" />
</div>

<div class="panel" id="analysis">
  <h2>Parsed Headers</h2>
</div>

<div class="panel" id="findings">
  <h2>Security Findings</h2>
</div>

<div class="panel" id="poc">
  <h2>Generated PoC / Markdown</h2>
  <textarea readonly style="height:200px;"></textarea>
</div>

<div class="panel" id="diffAB">
  <h2>Diff A vs B</h2>
</div>

<div class="panel" id="listSnaps">
  <h2>Saved Snapshots</h2>
  <div id="snapList"></div>
</div>

<script src="script.js"></script>
<script>
  // Initialize HeaderSleuth++ bindings
  if (window.HS && HS.bind && typeof HS.bind.start === 'function') HS.bind.start();
</script>

</body>
</html>
